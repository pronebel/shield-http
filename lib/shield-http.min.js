!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("shield-http",[],t):"object"==typeof exports?exports["shield-http"]=t():e["shield-http"]=t()}(window,function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=5)}([function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$successCode=t.successCode,this.$status=t.status||[],this.$bizcode=t.codes||[],this.assembleErrorMsg=t.error||function(){}}return function(e,t,n){t&&o(e.prototype,t),n&&o(e,n)}(e,[{key:"isSuccess",value:function(e){return"string"==typeof this.$successCode?this.$successCode===e:this.$successCode<=e}},{key:"proccessHttpError",value:function(e){for(var t=null,n=0;n<this.$status.length;n++){var r=this.$status[n];if(r.val===e){t=r;break}}return t?{message:t.message}:null}},{key:"processBizError",value:function(e){for(var t=null,n=0;n<this.$bizcode.length;n++){var o=this.$bizcode[n],i=o.val;if("function"===r(i)){if(i.apply(this,[e])){t=o;break}}else if(i instanceof RegExp){if(i.test(e)){t=o;break}}else if(o.val===e){t=o;break}}return t?(this.assembleErrorMsg(t),{}):null}}]),e}();t.default=i,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ContentType=t.Methods=void 0;t.Methods={POST:"POST",GET:"GET",PUT:"PUT",DELETE:"DELETE",PATCH:"PATCH"};t.ContentType={NORMAL:"application/x-www-form-urlencoded",RESTFUL:"application/json;charset=utf-8"}},function(e,t,n){"use strict";var r=Object.prototype.hasOwnProperty;function o(e){return decodeURIComponent(e.replace(/\+/g," "))}t.stringify=function(e,t){t=t||"";var n=[];for(var o in"string"!=typeof t&&(t="?"),e)r.call(e,o)&&n.push(encodeURIComponent(o)+"="+encodeURIComponent(e[o]));return n.length?t+n.join("&"):""},t.parse=function(e){for(var t,n=/([^=?&]+)=?([^&]*)/g,r={};t=n.exec(e);){var i=o(t[1]),s=o(t[2]);i in r||(r[i]=s)}return r}},function(e,t,n){var r,o;!function(i,s,u){void 0!==e&&e.exports?e.exports=u():void 0===(o="function"==typeof(r=u)?r.call(t,n,t,e):r)||(e.exports=o)}(0,0,function(){return function(){return function(e){var t=[];if(e[0].match(/^[^/:]+:\/*$/)&&e.length>1){var n=e.shift();e[0]=n+e[0]}e[0].match(/^file:\/\/\//)?e[0]=e[0].replace(/^([^/:]+):\/*/,"$1:///"):e[0]=e[0].replace(/^([^/:]+):\/*/,"$1://");for(var r=0;r<e.length;r++){var o=e[r];if("string"!=typeof o)throw new TypeError("Url must be a string. Received "+o);""!==o&&(r>0&&(o=o.replace(/^[\/]+/,"")),o=r<e.length-1?o.replace(/[\/]+$/,""):o.replace(/[\/]+$/,"/"),t.push(o))}var i=t.join("/"),s=(i=i.replace(/\/(\?|&|#[^!])/g,"$1")).split("?");return i=s.shift()+(s.length>0?"?":"")+s.join("&")}("object"==typeof arguments[0]?arguments[0]:[].slice.call(arguments))}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HttpExt=void 0;var r=u(n(3)),o=u(n(2)),i=n(1),s=u(n(0));function u(e){return e&&e.__esModule?e:{default:e}}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var c=function(){},l=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=Object.assign({progress:!0,silent:!1,timeout:1e5,defaultError:"报错啦"},t),this.apiPrefix=t.apiPrefix,this.envTransferType=t.envTransferType,this.injectHeaders(),this.$code=new s.default(this.options),this.$auth=n}return function(e,t,n){t&&a(e.prototype,t),n&&a(e,n)}(e,[{key:"injectHeaders",value:function(){var e={};this.options.isStream?e=void 0:e["content-type"]=i.ContentType.RESTFUL,this.headers=Object.assign({},e,this.options.headers)}},{key:"getToken",value:function(){return this.$auth.getToken?this.$auth.getToken():null}},{key:"getSystemInfo",value:function(){var e=this.options.getSystemInfo,t=e.call.apply(e,[this].concat(Array.prototype.slice.call(arguments))),n=this.getToken();return n&&(t.token=n),t}},{key:"mixUrl",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments[2],i=this.getSystemInfo(),s=this.options.pathPrefix||"";if("HEADER"===this.envTransferType){for(var u in i)this.headers[u]=i[u];return(0,r.default)(n||this.apiPrefix,s,e,o.default.stringify(t,"?"))}var a=Object.assign({},i,t);return(0,r.default)(n||this.apiPrefix,s,e,o.default.stringify(a,"?"))}},{key:"log",value:function(e){console.log(e)}},{key:"request",value:function(e){var t=this,n=Object.assign({},this.headers,e.headers),r=void 0===e.progress?this.options.progress:!!e.progress,o=void 0===e.silent?this.options.silent:!!e.silent;return this.showRequestState(r),new Promise(function(r,s){s=s||c;var u=t.msgErrTag();t.originalRequest({url:e.url,method:e.method||i.Methods.GET,data:e.data||{},header:n,cache:!1,timeout:t.options.timeout,success:function(e){var n=e.data;t.hideRequestState();var i=t.getResponseBizCode(n);if(t.$code.isSuccess(i))r(t.getResponseData(n));else{if(t.report(e),!o){var a=t.$code.processBizError(i);a&&t.showError(a.message||t.options.defaultError)}s({response:e,msgErrId:u,biz:1})}},fail:function(e){if(t.hideRequestState(),t.report(e),!o){var n=t.$code.proccessHttpError(t.getReponseHttpStatus(e));n&&t.showError(n.message||t.options.defaultError)}s({response:e,msgErrId:u})}})})}},{key:"getCacheKey",value:function(e,t){return e+JSON.stringify(t)}},{key:"$post",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=this.getCacheKey(e,t);return n.url=this.mixUrl(e,Object.assign({},r),n.apiUrl),n.cacheKey=o,n.method=i.Methods.POST,"[object Array]"===t.toString()?n.data=t:n.data=Object.assign({},t),this.request(n)}},{key:"$get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=Object.assign({},t),o=this.getCacheKey(e,t);return n.url=this.mixUrl(e,r,n.apiUrl),n.cacheKey=o,n.method=i.Methods.GET,this.request(n)}},{key:"msgErrTag",value:function(){return Math.random().toString(36).substring(2,15)}},{key:"showRequestState",value:function(e){}},{key:"hideRequestState",value:function(){}},{key:"showError",value:function(e){}},{key:"report",value:function(){}},{key:"getResponseData",value:function(e){}},{key:"getResponseBizCode",value:function(e){}},{key:"getReponseHttpStatus",value:function(e){return null}},{key:"originalRequest",value:function(e){}}]),e}();t.HttpExt=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"HttpExt",{enumerable:!0,get:function(){return r.default}});var r=function(e){return e&&e.__esModule?e:{default:e}}(n(4))}])});
//# sourceMappingURL=shield-http.min.js.map