{"version":3,"sources":["webpack://shield-http/webpack/universalModuleDefinition","webpack://shield-http/webpack/bootstrap","webpack://shield-http/./src/icode.js","webpack://shield-http/./src/constant.js","webpack://shield-http/./node_modules/querystringify/index.js","webpack://shield-http/./node_modules/url-join/lib/url-join.js","webpack://shield-http/./src/http.ext.js","webpack://shield-http/./src/index.js"],"names":["root","factory","exports","module","define","amd","window","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","icode","options","_classCallCheck","this","$successCode","successCode","$status","status","$bizcode","codes","assembleErrorMsg","error","code","codeVal","retErr","length","_code","val","message","checkVal","typename","apply","RegExp","test","POST","GET","PUT","DELETE","PATCH","NORMAL","RESTFUL","has","decode","input","decodeURIComponent","replace","stringify","obj","prefix","pairs","push","encodeURIComponent","join","parse","query","part","parser","result","exec","__WEBPACK_AMD_DEFINE_FACTORY__","__WEBPACK_AMD_DEFINE_RESULT__","context","definition","undefined","strArray","resultArray","match","first","shift","component","TypeError","str","parts","split","normalize","arguments","slice","_urlJoin","_interopRequireDefault","_querystringify","_constant","_icode","emptyFunction","HttpExt","auth","assign","progress","silent","timeout","defaultError","apiPrefix","envTransferType","injectHeaders","$code","default","$auth","headerConfig","isStream","ContentType","headers","getToken","getInfoFunc","getSystemInfo","envParams","concat","Array","token","bizurl","params","apiUrl","pathPrefix","getPramas","console","log","config","that","loadingBar","showRequestState","Promise","resolve","reject","msgErrId","msgErrTag","originalRequest","url","method","Methods","data","header","cache","success","response","resp","hideRequestState","retCode","getResponseBizCode","isSuccess","getResponseData","report","errResult","processBizError","showError","biz","fail","proccessHttpError","getReponseHttpStatus","JSON","opts","urlParam","cacheKey","getCacheKey","mixUrl","toString","request","Math","random","substring","_httpExt"],"mappings":"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","file":"shield-http.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"shield-http\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"shield-http\"] = factory();\n\telse\n\t\troot[\"shield-http\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 5);\n","/**\n * code判断\n * 假定:code是数字来设计的\n */\nexport default class icode {\n\n  constructor(options) {\n    this.$successCode = options.successCode;\n    this.$status = options.status || [];\n    /**\n     * code=[{\n         *  val:11111,\n         *  message:\"1111111111111\"\n         *\n         *\n         * }]\n     * @type {*|Array}\n     */\n    this.$bizcode = options.codes || [];\n    /**\n     * return {\n         *      message:xxxx\n         *\n         * }\n     * @type {*|Error|MediaError|Function}\n     */\n    this.assembleErrorMsg = options.error || function () {\n    };\n\n  }\n\n  isSuccess(code) {\n    if (typeof this.$successCode === 'string') {\n      if (this.$successCode === code) {\n        return true;\n      }\n      return false;\n\n    }\n    // 比如200位成功,大于200都算成功,小于200算失败\n    if (this.$successCode <= code) {\n      return true;\n    }\n    return false;\n\n  }\n\n  proccessHttpError(codeVal) {\n    let retErr = null;\n\n    for (let i = 0; i < this.$status.length; i++) {\n      let _code = this.$status[i];\n\n      if (_code.val === codeVal) {\n        retErr = _code;\n        break;\n      }\n    }\n\n    if (retErr) {\n\n      return {\n        message: retErr.message\n      };\n    }\n    return null;\n\n  }\n\n  processBizError(codeVal) {\n    let retErr = null;\n    let that = this;\n\n    for (let i = 0; i < this.$bizcode.length; i++) {\n      let _code = this.$bizcode[i];\n      let checkVal = _code.val;\n\n      let typename = typeof checkVal;\n\n      if (typename === 'function') {\n\n        if (checkVal.apply(that, [codeVal])) {\n          retErr = _code;\n          break;\n        }\n\n      } else if (checkVal instanceof RegExp) {\n        if (checkVal.test(codeVal)) {\n          retErr = _code;\n          break;\n        }\n      } else if (_code.val === codeVal) {\n        retErr = _code;\n        break;\n      }\n    }\n\n    if (retErr) {\n      this.assembleErrorMsg(retErr);\n      return {};\n    }\n    return null;\n\n  }\n\n}\n","/**\n * http method\n */\nexport let Methods = {\n  POST: 'POST',\n  GET: 'GET',\n  PUT: 'PUT',\n  DELETE: 'DELETE',\n  PATCH: 'PATCH'\n};\n\n/**\n * http-content-type\n * @type {{NORMAL: string, RESTFUL: string}}\n */\nexport let ContentType = {\n  NORMAL: 'application/x-www-form-urlencoded',\n  RESTFUL: 'application/json;charset=utf-8'\n\n};\n","'use strict';\n\nvar has = Object.prototype.hasOwnProperty;\n\n/**\n * Decode a URI encoded string.\n *\n * @param {String} input The URI encoded string.\n * @returns {String} The decoded string.\n * @api private\n */\nfunction decode(input) {\n  return decodeURIComponent(input.replace(/\\+/g, ' '));\n}\n\n/**\n * Simple query string parser.\n *\n * @param {String} query The query string that needs to be parsed.\n * @returns {Object}\n * @api public\n */\nfunction querystring(query) {\n  var parser = /([^=?&]+)=?([^&]*)/g\n    , result = {}\n    , part;\n\n  while (part = parser.exec(query)) {\n    var key = decode(part[1])\n      , value = decode(part[2]);\n\n    //\n    // Prevent overriding of existing properties. This ensures that build-in\n    // methods like `toString` or __proto__ are not overriden by malicious\n    // querystrings.\n    //\n    if (key in result) continue;\n    result[key] = value;\n  }\n\n  return result;\n}\n\n/**\n * Transform a query string to an object.\n *\n * @param {Object} obj Object that should be transformed.\n * @param {String} prefix Optional prefix.\n * @returns {String}\n * @api public\n */\nfunction querystringify(obj, prefix) {\n  prefix = prefix || '';\n\n  var pairs = [];\n\n  //\n  // Optionally prefix with a '?' if needed\n  //\n  if ('string' !== typeof prefix) prefix = '?';\n\n  for (var key in obj) {\n    if (has.call(obj, key)) {\n      pairs.push(encodeURIComponent(key) +'='+ encodeURIComponent(obj[key]));\n    }\n  }\n\n  return pairs.length ? prefix + pairs.join('&') : '';\n}\n\n//\n// Expose the module.\n//\nexports.stringify = querystringify;\nexports.parse = querystring;\n","(function (name, context, definition) {\n  if (typeof module !== 'undefined' && module.exports) module.exports = definition();\n  else if (typeof define === 'function' && define.amd) define(definition);\n  else context[name] = definition();\n})('urljoin', this, function () {\n\n  function normalize (strArray) {\n    var resultArray = [];\n\n    // If the first part is a plain protocol, we combine it with the next part.\n    if (strArray[0].match(/^[^/:]+:\\/*$/) && strArray.length > 1) {\n      var first = strArray.shift();\n      strArray[0] = first + strArray[0];\n    }\n\n    // There must be two or three slashes in the file protocol, two slashes in anything else.\n    if (strArray[0].match(/^file:\\/\\/\\//)) {\n      strArray[0] = strArray[0].replace(/^([^/:]+):\\/*/, '$1:///');\n    } else {\n      strArray[0] = strArray[0].replace(/^([^/:]+):\\/*/, '$1://');\n    }\n\n    for (var i = 0; i < strArray.length; i++) {\n      var component = strArray[i];\n\n      if (typeof component !== 'string') {\n        throw new TypeError('Url must be a string. Received ' + component);\n      }\n\n      if (component === '') { continue; }\n\n      if (i > 0) {\n        // Removing the starting slashes for each component but the first.\n        component = component.replace(/^[\\/]+/, '');\n      }\n      if (i < strArray.length - 1) {\n        // Removing the ending slashes for each component but the last.\n        component = component.replace(/[\\/]+$/, '');\n      } else {\n        // For the last component we will combine multiple slashes to a single one.\n        component = component.replace(/[\\/]+$/, '/');\n      }\n\n      resultArray.push(component);\n\n    }\n\n    var str = resultArray.join('/');\n    // Each input component is now separated by a single slash except the possible first plain protocol part.\n\n    // remove trailing slash before parameters or hash\n    str = str.replace(/\\/(\\?|&|#[^!])/g, '$1');\n\n    // replace ? in parameters with &\n    var parts = str.split('?');\n    str = parts.shift() + (parts.length > 0 ? '?': '') + parts.join('&');\n\n    return str;\n  }\n\n  return function () {\n    var input;\n\n    if (typeof arguments[0] === 'object') {\n      input = arguments[0];\n    } else {\n      input = [].slice.call(arguments);\n    }\n\n    return normalize(input);\n  };\n\n});\n","import urljoin from 'url-join';\nimport Params from 'querystringify';\nimport {Methods, ContentType} from './constant';\n\nimport ICode from './icode';\n\nlet emptyFunction = function () {\n};\n\nexport default class HttpExt {\n\n  /**\n   * options:{\n     *  apiPrefix:'api前缀'\n     *  successCode:200,\n     *  codes:[\n     *      {\n     *          val:1000,\n     *          message:'逻辑问题描述'\n     *      }\n     *  ],\n     *  error:function(){\n     *      错误处理方式\n     *  }\n     *\n     * }\n   * @param options\n   */\n  constructor(options, auth) {\n\n    this.options = Object.assign({\n      progress: true,\n      silent: false,\n      timeout: 100000,\n      defaultError: '报错啦'\n    }, options);\n    this.apiPrefix = options.apiPrefix;\n    this.envTransferType = options.envTransferType;\n\n    this.injectHeaders();\n\n    this.$code = new ICode(this.options);\n\n    /**\n     * 确保有以下几种方式:\n     * getToken\n     * setToken\n     * clear\n     */\n    this.$auth = auth;\n  }\n\n  /**\n   * 设置头部 header 变量\n   */\n  injectHeaders() {\n    let headerConfig = {};\n\n    if (this.options.isStream) {\n      headerConfig = undefined; // 'application/octet-stream';\n    } else {\n      headerConfig['content-type'] = ContentType.RESTFUL;\n    }\n    this.headers = Object.assign({}, headerConfig, this.options.headers);\n\n  }\n\n  getToken() {\n    return this.$auth.getToken ? this.$auth.getToken() : null;\n  }\n\n  getSystemInfo() {\n    /**\n     {\n           callerApp: \"ICRMCLIENT\",\n           pageUrl: getCurrentPage(),\n           userType: 'BANK_CUSTOMER'\n       }\n     *\n     */\n    let getInfoFunc = this.options.getSystemInfo;\n    let envParams = getInfoFunc.call(this, ...arguments);\n\n    let token = this.getToken();\n\n    if (token) {\n      envParams['token'] = token;\n    }\n    return envParams;\n  }\n\n  mixUrl(bizurl, params = {}, apiUrl) {\n\n    let envParams = this.getSystemInfo();\n\n    let pathPrefix = this.options.pathPrefix || '';\n\n    if (this.envTransferType === 'HEADER') {\n\n      for (let key in envParams) {\n        this.headers[key] = envParams[key];\n      }\n      return urljoin((apiUrl || this.apiPrefix), pathPrefix, bizurl, Params.stringify(params, '?'));\n    }\n    let getPramas = Object.assign({}, envParams, params);\n\n    return urljoin((apiUrl || this.apiPrefix), pathPrefix, bizurl, Params.stringify(getPramas, '?'));\n\n  }\n\n  log(str) {\n    console.log(str);\n  }\n\n  /**\n   * http的封装\n   * @param opts:{\n *\n *  cache:{       //cache不传则不开启\n *    exp:1,      //0 不开启\n *    read:-1,    //-1不开启\n *  }\n * }\n   * @param parseFunc\n   * @returns {*}\n   */\n  request(config) {\n    let that = this;\n    let headerConfig = Object.assign({}, this.headers, config.headers);\n\n    let loadingBar = config.progress === undefined ? this.options.progress : !!config.progress;\n    let silent = config.silent === undefined ? this.options.silent : !!config.silent;\n\n    this.showRequestState(loadingBar);\n\n    let promise = new Promise(function (resolve, reject) {\n\n      reject = reject || emptyFunction;\n      let msgErrId = that.msgErrTag();\n\n      that.originalRequest({\n        url: config.url,\n        method: config.method || Methods.GET,\n        data: config.data || {},\n        header: headerConfig,\n        cache: false,\n        timeout: that.options.timeout,\n\n        success: function (response) {\n\n          let resp = response.data;\n\n          that.hideRequestState();\n\n          let retCode = that.getResponseBizCode(resp);\n\n          if (that.$code.isSuccess(retCode)) {\n            resolve(that.getResponseData(resp));\n          } else {\n\n            that.report(response);\n            if (!silent) {\n              let errResult = that.$code.processBizError(retCode);\n\n              if (errResult) {\n                that.showError(errResult.message || that.options.defaultError);\n              }\n\n            }\n\n            reject({response, msgErrId, biz: 1});\n          }\n        },\n        fail: function (response) {\n\n          that.hideRequestState();\n          that.report(response);\n          if (!silent) {\n            let errResult = that.$code.proccessHttpError(that.getReponseHttpStatus(response));\n\n            if (errResult) {\n              that.showError(errResult.message || that.options.defaultError);\n            }\n          }\n\n          reject({response, msgErrId});\n\n        }\n      });\n\n    });\n\n    return promise;\n  }\n\n  getCacheKey(url, data) {\n    return url + JSON.stringify(data);\n  }\n\n  $post(url, data = {}, opts = {}, urlParam = {}) {\n\n    let cacheKey = this.getCacheKey(url, data);\n\n    opts.url = this.mixUrl(url, Object.assign({}, urlParam), opts.apiUrl);\n    opts.cacheKey = cacheKey;\n    opts.method = Methods.POST;\n\n    if (data.toString() === '[object Array]') {\n      opts.data = data;\n    } else {\n      opts.data = Object.assign({}, data);\n    }\n\n    return this.request(opts);\n  }\n\n  $get(url, data = {}, opts = {}) {\n    let params = Object.assign({}, data);\n    let cacheKey = this.getCacheKey(url, data);\n\n    opts.url = this.mixUrl(url, params, opts.apiUrl);\n    opts.cacheKey = cacheKey;\n    opts.method = Methods.GET;\n\n    return this.request(opts);\n  }\n\n  msgErrTag() {\n    return Math.random().toString(36).substring(2, 15);\n  }\n\n  // ////////////////////////////////////  需要根据实际情况重载  //////////////////////////////////////////////////////\n  showRequestState(loadingBar) {\n\n    //\n  }\n\n  hideRequestState() {\n    /*\n\n                if (loadingBar) {\n                    AjaxLoading.close()\n                }\n     */\n  }\n\n  showError(resp) {\n\n    // dialog.alert(resp.retMessage || resp.exception || \"服务器错误\")\n\n  }\n\n  report() {\n\n  }\n\n  getResponseData(resp) {\n\n  }\n\n  getResponseBizCode(resp) {\n\n  }\n\n  getReponseHttpStatus(response) {\n\n    return null;\n  }\n\n  // //////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n  originalRequest(options) {\n    // this.assembleRequestOptions(options)\n\n  }\n\n}\n","import HttpExt from './http.ext.js';\n\nexport {HttpExt};\n"],"sourceRoot":""}